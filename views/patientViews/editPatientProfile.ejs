<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Patient Profile</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>

<div class="container">
    <h1 class="mt-4 mb-4">Edit Patient Profile</h1>
    <form action="/patients/edit/<%= patient._id %>" method="POST">
        <div class="accordion" id="editPatientAccordion">

            <!-- Personal Details -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingPersonalDetails">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePersonalDetails">
                        Personal Details
                    </button>
                </h2>
                <div id="collapsePersonalDetails" class="accordion-collapse collapse show" data-bs-parent="#editPatientAccordion">
                    <div class="accordion-body">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="firstName">First Name:</label>
                                <input type="text" class="form-control" id="firstName" name="firstName" value="<%= patient.firstName %>" required>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="lastName">Last Name:</label>
                                <input type="text" class="form-control" id="lastName" name="lastName" value="<%= patient.lastName %>" required>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="dateOfBirth">Date of Birth:</label>
                                <input type="date" class="form-control" id="dateOfBirth" name="dateOfBirth" value="<%= patient.dateOfBirth ? new Date(patient.dateOfBirth).toISOString().split('T')[0] : ''  %>">
                            </div>

                            <div class="form-group col-md-6">
                                <label for="gender">Gender:</label>
                                <select class="form-control" id="gender" name="gender" required>
                                    <option value="male" <%= patient.gender === 'male' ? 'selected' : '' %>>Male</option>
                                    <option value="female" <%= patient.gender === 'female' ? 'selected' : '' %>>Female</option>
                                    <option value="other" <%= patient.gender === 'other' ? 'selected' : '' %>>Other</option>
                                </select>
                            </div>

                            <div class="form-group col-md-6">
                                <label for="occupation">Occupation:</label>
                                <input type="text" class="form-control" id="occupation" name="occupation" value="<%= patient.occupation %>">
                            </div>

                            <div class="form-group col-md-6">
                                <label for="maritalStatus">Marital Status:</label>
                                <select class="form-control" id="maritalStatus" name="maritalStatus">
                                    <option value="single" <%= patient.maritalStatus === 'single' ? 'selected' : '' %>>Single</option>
                                    <option value="married" <%= patient.maritalStatus === 'married' ? 'selected' : '' %>>Married</option>
                                    <option value="divorced" <%= patient.maritalStatus === 'divorced' ? 'selected' : '' %>>Divorced</option>
                                    <option value="widowed" <%= patient.maritalStatus === 'widowed' ? 'selected' : '' %>>Widowed</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Address -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingAddress">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseAddress">
                        Address
                    </button>
                </h2>
                <div id="collapseAddress" class="accordion-collapse collapse" data-bs-parent="#editPatientAccordion">
                    <div class="accordion-body">
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="street">Street:</label>
                                <input type="text" class="form-control" id="street" name="street" value="<%= patient.address.street %>">
                            </div>

                            <div class="form-group col-md-4">
                                <label for="city">City:</label>
                                <input type="text" class="form-control" id="city" name="city" value="<%= patient.address.city %>">
                            </div>

                            <div class="form-group col-md-4">
                                <label for="state">State:</label>
                                <input type="text" class="form-control" id="state" name="state" value="<%= patient.address.state %>">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingContact">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseContact">
                        Contact Information
                    </button>
                </h2>
                <div id="collapseContact" class="accordion-collapse collapse" data-bs-parent="#editPatientAccordion">
                    <div class="accordion-body">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="phone">Phone:</label>
                                <input type="tel" class="form-control" id="phone" name="phone" value="<%= patient.contact.phone %>">
                            </div>

                            <div class="form-group col-md-6">
                                <label for="email">Email:</label>
                                <input type="email" class="form-control" id="email" name="email" value="<%= patient.contact.email %>">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Insurance -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingInsurance">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInsurance">
                        Insurance
                    </button>
                </h2>
                <div id="collapseInsurance" class="accordion-collapse collapse" data-bs-parent="#editPatientAccordion">
                    <div class="accordion-body">
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="provider">Provider:</label>
                                <input type="text" class="form-control" id="provider" name="provider" value="<%= patient.insurance.providerName %>">
                            </div>

                            <div class="form-group col-md-6">
                                <label for="policyNumber">Policy Number:</label>
                                <input type="text" class="form-control" id="policyNumber" name="policyNumber" value="<%= patient.insurance.policyNumber %>">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Emergency Contact -->
<div class="accordion-item">
    <h2 class="accordion-header" id="headingEmergencyContact">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEmergencyContact">
            Emergency Contact
        </button>
    </h2>
    <div id="collapseEmergencyContact" class="accordion-collapse collapse" data-bs-parent="#editPatientAccordion">
        <div class="accordion-body">
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label for="emergencyPhone">Emergency Phone:</label>
                    <input type="tel" class="form-control" id="emergencyPhone" name="emergencyPhone" value="<%= patient.emergencyContact.phone %>">
                </div>

                <div class="form-group col-md-6">
                    <label for="emergencyEmail">Emergency Email:</label>
                    <input type="email" class="form-control" id="emergencyEmail" name="emergencyEmail" value="<%= patient.emergencyContact.email %>">
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Medical History -->
<div class="accordion-item">
    <h2 class="accordion-header" id="headingMedicalHistory">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMedicalHistory">
            Medical History
        </button>
    </h2>
    <div id="collapseMedicalHistory" class="accordion-collapse collapse" data-bs-parent="#editPatientAccordion">
        <div class="accordion-body">
            <!-- Allergies -->
            <div class="form-group">
                <label for="allergies">Allergies (comma separated):</label>
                <input type="text" class="form-control" id="allergies" name="allergies" value="<%= patient.medicalHistory.allergies.join(', ') %>">
            </div>

            <!-- Medications -->
            <div class="form-group">
                <label for="medications">Medications (comma separated):</label>
                <input type="text" class="form-control" id="medications" name="medications" value="<%= patient.medicalHistory.medications.join(', ') %>">
            </div>

            <!-- Chronic Diseases -->
            <div class="form-group">
                <label for="chronicDiseases">Chronic Diseases (comma separated):</label>
                <input type="text" class="form-control" id="chronicDiseases" name="chronicDiseases" value="<%= patient.medicalHistory.chronicDiseases.join(', ') %>">
            </div>

            <!-- Family Background -->
            <div class="form-group">
                <label for="familyBackground">Family Background:</label>
                <textarea class="form-control" id="familyBackground" name="familyBackground"><%= patient.medicalHistory.familyBackground %></textarea>
            </div>

            <!-- Gynecological History -->
            <div class="form-group">
                <label for="pregnancies">Number of Pregnancies:</label>
                <input type="number" class="form-control" id="pregnancies" name="pregnancies" value="<%= patient.medicalHistory.gynecologicalHistory.pregnancies %>">
            </div>

            <!-- Non-Pathological History -->
            <div class="form-group">
                <label for="surgeries">Surgeries:</label>
                <input type="text" class="form-control" id="surgeries" name="surgeries" value="<%= patient.medicalHistory.nonPathologicalHistory.surgeries %>">
            </div>

            <div class="form-group">
                <label for="traumas">Traumas:</label>
                <input type="text" class="form-control" id="traumas" name="traumas" value="<%= patient.medicalHistory.nonPathologicalHistory.traumas %>">
            </div>

            <div class="form-group">
                <label for="transfusions">Transfusions:</label>
                <input type="text" class="form-control" id="transfusions" name="transfusions" value="<%= patient.medicalHistory.nonPathologicalHistory.transfusions %>">
            </div>

            <div class="form-group">
                <label for="smoking">Smoking:</label>
                <input type="text" class="form-control" id="smoking" name="smoking" value="<%= patient.medicalHistory.nonPathologicalHistory.smoking %>">
            </div>

            <div class="form-group">
                <label for="alcoholConsumption">Alcohol Consumption:</label>
                <input type="text" class="form-control" id="alcoholConsumption" name="alcoholConsumption" value="<%= patient.medicalHistory.nonPathologicalHistory.alcoholConsumption %>">
            </div>

            <div class="form-group">
                <label for="immunizations">Immunizations (comma separated):</label>
                <input type="text" class="form-control" id="immunizations" name="immunizations" value="<%= patient.medicalHistory.nonPathologicalHistory.immunizations.join(', ') %>">
            </div>
        </div>
    </div>
</div>



        </div>



        <button type="submit" class="btn btn-primary mt-4">Save Changes</button>
        <a href="/patients/<%= patient._id %>" class="btn btn-secondary mt-4">Cancel</a>
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

</body>
</html>
